{"version":3,"file":"angular-fire-functions.js","sources":["../../../src/functions/base.ts","../../../src/functions/functions.ts","../../../src/functions/functions.module.ts"],"names":[],"mappings":"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","sourcesContent":["export const proxyPolyfillCompat = {\n  useEmulator: null,\n  useFunctionsEmulator: null,\n  httpsCallable: null,\n};\n","import { Inject, Injectable, InjectionToken, NgZone, Optional } from '@angular/core';\nimport { from, Observable, of } from 'rxjs';\nimport { map, observeOn, shareReplay, switchMap } from 'rxjs/operators';\nimport {\n  FIREBASE_APP_NAME,\n  FIREBASE_OPTIONS,\n  FirebaseAppConfig,\n  FirebaseOptions,\n  ɵAngularFireSchedulers,\n  ɵfirebaseAppFactory,\n  ɵlazySDKProxy,\n  ɵPromiseProxy,\n  ɵapplyMixins\n} from '@angular/fire';\nimport firebase from 'firebase/app';\nimport { proxyPolyfillCompat } from './base';\nimport { HttpsCallableOptions } from '@firebase/functions-types';\nimport { ɵfetchInstance } from '@angular/fire';\n\nexport const ORIGIN = new InjectionToken<string>('angularfire2.functions.origin');\nexport const REGION = new InjectionToken<string>('angularfire2.functions.region');\nexport const NEW_ORIGIN_BEHAVIOR = new InjectionToken<boolean>('angularfire2.functions.new-origin-behavior');\n\n// SEMVER(7): use Parameters to detirmine the useEmulator arguments\n// type UseEmulatorArguments = Parameters<typeof firebase.functions.Functions.prototype.useEmulator>;\ntype UseEmulatorArguments = [string, number];\nexport const USE_EMULATOR = new InjectionToken<UseEmulatorArguments>('angularfire2.functions.use-emulator');\n\n// override httpsCallable for compatibility with 5.x\nexport interface AngularFireFunctions extends Omit<ɵPromiseProxy<firebase.functions.Functions>, 'httpsCallable'> {\n}\n\n@Injectable({\n  providedIn: 'any'\n})\nexport class AngularFireFunctions {\n\n  public readonly httpsCallable: <T = any, R = any>(name: string, options?: HttpsCallableOptions) => (data: T) => Observable<R>;\n\n  constructor(\n    @Inject(FIREBASE_OPTIONS) options: FirebaseOptions,\n    @Optional() @Inject(FIREBASE_APP_NAME) nameOrConfig: string | FirebaseAppConfig | null | undefined,\n    zone: NgZone,\n    @Optional() @Inject(REGION) region: string | null,\n    @Optional() @Inject(ORIGIN) origin: string | null,\n    @Optional() @Inject(NEW_ORIGIN_BEHAVIOR) newOriginBehavior: boolean | null,\n    @Optional() @Inject(USE_EMULATOR) _useEmulator: any, // can't use the tuple here\n  ) {\n    const schedulers = new ɵAngularFireSchedulers(zone);\n    const useEmulator: UseEmulatorArguments | null = _useEmulator;\n\n    const functions = of(undefined).pipe(\n      observeOn(schedulers.outsideAngular),\n      switchMap(() => import('firebase/functions')),\n      map(() => ɵfirebaseAppFactory(options, zone, nameOrConfig)),\n      map(app => ɵfetchInstance(`${app.name}.functions.${region || origin}`, 'AngularFireFunctions', app, () => {\n        let functions: firebase.functions.Functions;\n        if (newOriginBehavior) {\n          if (region && origin) {\n            throw new Error('REGION and ORIGIN can\\'t be used at the same time.');\n          }\n          functions = app.functions(region || origin || undefined);\n        } else {\n          functions = app.functions(region || undefined);\n        }\n        if (!newOriginBehavior && !useEmulator && origin) {\n          functions.useFunctionsEmulator(origin);\n        }\n        if (useEmulator) {\n          functions.useEmulator(...useEmulator);\n        }\n        return functions;\n      }, [region, origin, useEmulator])),\n      shareReplay({ bufferSize: 1, refCount: false })\n    );\n\n    this.httpsCallable = <T = any, R = any>(name: string, options?: HttpsCallableOptions) =>\n      (data: T) => from(functions).pipe(\n        observeOn(schedulers.insideAngular),\n        switchMap(functions => functions.httpsCallable(name, options)(data)),\n        map(r => r.data as R)\n      );\n\n    return ɵlazySDKProxy(this, functions, zone);\n\n  }\n\n}\n\nɵapplyMixins(AngularFireFunctions, [proxyPolyfillCompat]);\n","import { NgModule } from '@angular/core';\nimport { AngularFireFunctions } from './functions';\n\n@NgModule({\n  providers: [ AngularFireFunctions ]\n})\nexport class AngularFireFunctionsModule { }\n"]}